<section #whySection class="relative w-full min-h-screen overflow-hidden py-24">
  <!-- Seamless particle background continuation -->
  <app-particle-background
    class="absolute inset-0 pointer-events-none z-0"
    [accent]="safeTheme.accent"
    [accentRgb]="safeTheme.accentRGB"
    [swapTrigger]="swapTrigger"
    mode="section"
    fitMode="container">
  </app-particle-background>
  
  <!-- Noise texture overlay for premium aesthetic -->
  <div class="noise-layer absolute inset-0 opacity-[0.08] pointer-events-none z-[1]"></div>
  
  <!-- Vignette layer for depth -->
  <div class="vignette-layer absolute inset-0 pointer-events-none z-[2]"></div>

  <div class="content-wrapper relative z-10 container mx-auto px-6 lg:px-8">
    
    <!-- SECTION 1: Header -->
    <div class="pt-24 pb-16 text-center max-w-4xl mx-auto">
      <h2 class="text-4xl md:text-5xl lg:text-6xl font-light mb-8 leading-tight" [ngStyle]="{ 'color': safeTheme.text }">
        <span class="bg-clip-text text-transparent font-medium" 
              [class.emotional-pulse]="headlineTypingComplete"
              [ngStyle]="{ 'background-image': `linear-gradient(to right, ${safeTheme.accent}, ${safeTheme.btnBg}, ${safeTheme.accent})` }">
          {{ displayHeadline }}<span *ngIf="typingStarted && !headlineTypingComplete" class="caret" [ngStyle]="{ 'color': safeTheme.accent }">&nbsp;</span>
        </span>
      </h2>
      <div class="relative max-w-3xl mx-auto" [style.--accent-rgb]="safeTheme.accentRGB">
        <div class="orbit-ring" [class.visible]="subheadlineTypingComplete"></div>
        <p class="relative z-10 text-lg md:text-xl leading-relaxed" [ngStyle]="{ 'color': safeTheme.muted }">
          {{ displaySubheadline }}<span *ngIf="headlineTypingComplete && !subheadlineTypingComplete" class="caret" [ngStyle]="{ 'color': safeTheme.accent }">&nbsp;</span>
        </p>
      </div>
    </div>

    <!-- SECTION 2: Value Pillars -->
    <div class="pb-20">
      <div class="grid md:grid-cols-3 gap-8 max-w-7xl mx-auto">
        <div 
          *ngFor="let pillar of valuePillars; let i = index; trackBy: trackByTitle" 
          class="group relative backdrop-blur-sm rounded-2xl px-8 py-10 transition-all duration-500 hover:scale-[1.02] hover:shadow-[0_20px_60px_-10px_var(--hover-shadow-color)] feature-card"
          (mouseenter)="onCardHover(i)"
          (mouseleave)="onCardLeave(i)"
          [ngStyle]="{  
            'background-color': getCardBackground(),
            'border': '1px solid ' + getCardBorder(),
            '--hover-shadow-color': getGlowColor()
          }"
          [ngClass]="{
            'card-hidden': !cardsAnimated,
            'animate-card-drop-1': cardsAnimated && i === 0,
            'animate-card-drop-2': cardsAnimated && i === 1,
            'animate-card-drop-3': cardsAnimated && i === 2
          }"
        >
          <div class="text-center">
            <!-- Media for first card (Brain) -->
            <div *ngIf="i === 0" class="relative mb-6 rounded-xl overflow-hidden h-40 w-full shadow-lg">
              <img
                src="/assets/pictures/brain.png"
                alt="Emotional intelligence visualization"
                class="absolute inset-0 w-full h-full object-cover transition-opacity duration-700 ease-in-out group-hover:opacity-0"
              />
              <video
                #videoPlayer
                src="/assets/videos/brain.mp4"
                autoplay
                muted
                loop
                playsinline
                preload="auto"
                class="absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-700 ease-in-out group-hover:opacity-100"
              ></video>
            </div>

            <!-- Emoji for other cards -->
            <div *ngIf="i !== 0" class="text-5xl mb-6 group-hover:scale-110 transition-transform duration-300">
              {{ pillar.icon }}
            </div>

            <h3 class="text-xl md:text-2xl font-semibold mb-4 leading-tight" [ngStyle]="{ 'color': safeTheme.text }">
              {{ pillar.title }}
            </h3>
            <p class="leading-relaxed" [ngStyle]="{ 'color': safeTheme.muted }">
              {{ pillar.description }}
            </p>
          </div>
          
          <!-- Subtle glow effect -->
          <div
            class="absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10" 
            [ngStyle]="{ 'background': 'linear-gradient(to right, ' + getParticleGlow(0.1) + ', ' + getParticleGlow(0.15) + ')' }"
          ></div>
        </div>
      </div>
    </div>
    

    <!-- SECTION 3: Use Case Grid -->
    <div class="pb-20">
      <div class="grid lg:grid-cols-2 gap-6 max-w-6xl mx-auto">
        <div 
          *ngFor="let useCase of useCases; trackBy: trackByTitle" 
          class="group backdrop-blur-sm rounded-xl p-6 md:p-8 transition-all duration-300 hover:shadow-xl use-case-fade-in"
          [ngStyle]="{ 
            'background-color': getCardBackground(),
            'border': `1px solid ${getCardBorder()}`,
            '--hover-bg': getCardHoverBackground(),
            '--hover-shadow-color': getGlowColor()
          }"
          [class]="'hover:shadow-[0_10px_40px_-10px_var(--hover-shadow-color)] hover:bg-[var(--hover-bg)]'"
        >
          <!-- Tag -->
          <div class="inline-flex items-center px-3 py-1 rounded-full mb-4" 
               [ngStyle]="{ 
                 'background-color': getTagBackground(),
                 'border': `1px solid ${getTagBorder()}`
               }">
            <span class="text-xs font-medium uppercase tracking-wider" [ngStyle]="{ 'color': safeTheme.accent }">
              {{ useCase.tag }}
            </span>
          </div>

          <!-- Title -->
          <h4 class="text-xl md:text-2xl font-semibold mb-3" [ngStyle]="{ 'color': safeTheme.text }">
            {{ useCase.title }}
          </h4>

          <!-- Description -->
          <p class="mb-6 leading-relaxed" [ngStyle]="{ 'color': safeTheme.muted }">
            {{ useCase.description }}
          </p>

          <!-- Benefits List -->
          <ul class="space-y-2 mb-4">
            <li 
              *ngFor="let benefit of useCase.benefits" 
              class="flex items-start text-sm"
              [ngStyle]="{ 'color': safeTheme.muted }"
            >
              <div class="w-1.5 h-1.5 rounded-full mr-3 mt-2 flex-shrink-0" [ngStyle]="{ 'background-color': safeTheme.accent }"></div>
              {{ benefit }}
            </li>
          </ul>

          <!-- Optional CTA -->
          <button class="text-sm font-medium transition-colors duration-200 group-hover:translate-x-1 transform" 
                  [ngStyle]="{ 'color': safeTheme.accent }"
                  [class]="'hover:brightness-110'">
            Try it now →
          </button>
        </div>
      </div>
    </div>

    <!-- SECTION 4: Social Proof Strip -->
    <div class="text-center max-w-md mx-auto mt-20 mb-20 social-proof-fade-in">
      <!-- Stars -->
      <div class="flex justify-center mb-4 space-x-1">
        <svg 
          *ngFor="let star of stars" 
          class="w-5 h-5 fill-current animate-glow" 
          viewBox="0 0 20 20"
          [ngStyle]="{ 'color': safeTheme.accent }"
        >
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
        </svg>
      </div>

      <!-- Quote -->
      <blockquote class="text-lg md:text-xl italic mb-4 leading-relaxed" [ngStyle]="{ 'color': safeTheme.text }">
        "More present and comforting than any AI companion I've tried."
      </blockquote>

      <!-- Attribution -->
      <p class="text-sm" [ngStyle]="{ 'color': safeTheme.muted }">
        — Verified User
      </p>
    </div>

    <!-- SECTION 5: Final CTA -->
    <div class="text-center pb-24 final-cta-fade-in">
      <div class="max-w-2xl mx-auto">
        <h3 class="text-3xl md:text-4xl lg:text-5xl font-light mb-6 leading-tight" [ngStyle]="{ 'color': safeTheme.text }">
          Find a 
          <span class="bg-clip-text text-transparent font-medium" [ngStyle]="{ 'background-image': `linear-gradient(to right, ${safeTheme.accent}, ${safeTheme.btnBg})` }">
            Companion Tailored to You
          </span>
        </h3>
        
        <p class="text-lg mb-10 leading-relaxed" [ngStyle]="{ 'color': safeTheme.muted }">
          Start your journey with an AI companion who understands you, grows with you, and is always there when you need support.
        </p>

        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
          <!-- Primary CTA -->
          <button class="group relative inline-flex items-center px-8 py-4 rounded-full font-semibold text-lg hover:scale-[1.03] hover:shadow-2xl transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2"
                  [ngStyle]="{ 
                    'background': getButtonGradient(),
                    'color': safeTheme.btnText,
                    '--hover-shadow-color': getGlowColor(),
                    '--focus-color': safeTheme.accent
                  }"
                  [class]="'hover:shadow-[0_20px_60px_-10px_var(--hover-shadow-color)] focus:ring-[var(--focus-color)] focus:ring-offset-[' + safeTheme.bgStart + ']'">
            <span class="relative z-10">Meet Your Companion</span>
            <div class="absolute inset-0 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300" 
                 [ngStyle]="{ 'background': `linear-gradient(to right, ${safeTheme.btnBg}, ${safeTheme.accent})` }"></div>
          </button>

          <!-- Secondary CTA -->
          <button class="font-medium transition-colors duration-200 hover:underline hover:brightness-110" 
                  [ngStyle]="{ 'color': safeTheme.accent }">
            See how it works
          </button>
        </div>
      </div>
    </div>

  </div>
</section>